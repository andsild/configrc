#!/usr/bin/env bash

# "pdf" is just an function to open up pdf, can be replaced by
# "setsid evince ${file}" or similar
source /home/andesil/dotfiles/Bash/pdf

pdfautoopen()
{
    while out="$(inotifywait  -e create "${HOME}/Downloads/")"
    do 
        file="$(ls -t -r -1 "${HOME}/Downloads/" | tail -n1)"
        if [[ ! "${out}" == *"chromium"* ]]
        then 
            if [[ ! "${file}" == *".crdownload" ]]
            then 
                if [ "$(xdg-mime query filetype "${HOME}/Downloads/${file}")" = "application/pdf" ] 
                then 
                    pdf "${HOME}/Downloads/${file}"
                fi
            fi
        fi
    done
} 2> /dev/null

pdfautoopen
